# Find a function that can be used to locate toolchain executables.
#
# This may be provided by the `which` plugin when we're using the build system's
# toolchain, but sometimes we need to use a different (built) toolchain.
which = args.which ? import('which');
platform = args.platform ? import('platform');

raw_c = import('c', platform=platform, which=which);
c = raw_c.default;

shell = import('shell.fab');

tblgen = import('tblgen.fab',
	clang_tblgen=which.executable('clang-tblgen'),
	llvm_tblgen=which.executable('llvm-tblgen'),
).tblgen;

headers = function(srcs:list[file], dest_dir:file): list[file]
{
	for src in srcs
	{
		shell.copy(src, file(src.filename, subdir=dest_dir))
	}
};

man_page = function(src: file, links:list[string]=[]): list[file]
{
	# TODO: implement!
	[]
};

fabfiles = files(fabfile shell.fab tblgen.fab) + raw_c.fabfiles;
